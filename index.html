<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Surf Dakar - Prévisions & Marées</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-900">
  <header class="bg-blue-600 text-white p-4 text-center text-xl font-bold">
    Surf Dakar 🌊 - Prévisions & Marées
  </header>

  <main class="p-4 space-y-6">

    <!-- Spot Yoff -->
    <div id="yoff" class="bg-white rounded-xl shadow-md p-4">
      <h2 class="text-lg font-bold">🏄 Yoff</h2>
      <p class="wave">🌊 Vagues: Chargement...</p>
      <p class="wind">💨 Vent: Chargement...</p>
      <p class="temp">🌡️ Température: Chargement...</p>
    </div>

    <!-- Spot Almadies -->
    <div id="almadies" class="bg-white rounded-xl shadow-md p-4">
      <h2 class="text-lg font-bold">🏄 Almadies</h2>
      <p class="wave">🌊 Vagues: Chargement...</p>
      <p class="wind">💨 Vent: Chargement...</p>
      <p class="temp">🌡️ Température: Chargement...</p>
    </div>

    <!-- Spot Virage -->
    <div id="virage" class="bg-white rounded-xl shadow-md p-4">
      <h2 class="text-lg font-bold">🏄 Virage</h2>
      <p class="wave">🌊 Vagues: Chargement...</p>
      <p class="wind">💨 Vent: Chargement...</p>
      <p class="temp">🌡️ Température: Chargement...</p>
    </div>

    <!-- Spot Ngor -->
    <div id="ngor" class="bg-white rounded-xl shadow-md p-4">
      <h2 class="text-lg font-bold">🏄 Ngor</h2>
      <p class="wave">🌊 Vagues: Chargement...</p>
      <p class="wind">💨 Vent: Chargement...</p>
      <p class="temp">🌡️ Température: Chargement...</p>
    </div>

    <!-- Spot Ouakam -->
    <div id="ouakam" class="bg-white rounded-xl shadow-md p-4">
      <h2 class="text-lg font-bold">🏄 Ouakam</h2>
      <p class="wave">🌊 Vagues: Chargement...</p>
      <p class="wind">💨 Vent: Chargement...</p>
      <p class="temp">🌡️ Température: Chargement...</p>
    </div>

  </main>

  <footer class="bg-gray-800 text-white p-4 text-center">
    Données fournies par Open-Meteo (Marine API)
  </footer>

  <script>
    async function getSpotData(lat, lon, spotId) {
      try {
        const url = `https://marine-api.open-meteo.com/v1/marine?latitude=${lat}&longitude=${lon}&hourly=wave_height,wave_period,wind_speed,wind_direction,water_temperature&timezone=Africa%2FAbidjan`;
        const res = await fetch(url);
        const data = await res.json();

        // Heure actuelle
        const now = new Date().getHours();
        const waveHeight = data.hourly.wave_height[now];
        const wavePeriod = data.hourly.wave_period[now];
        const windSpeed = data.hourly.wind_speed[now];
        const windDir = data.hourly.wind_direction[now];
        const waterTemp = data.hourly.water_temperature[now];

        // Injection dans le HTML
        document.querySelector(`#${spotId} .wave`).textContent =
          `🌊 Vagues: ${waveHeight} m / ${wavePeriod}s`;
        document.querySelector(`#${spotId} .wind`).textContent =
          `💨 Vent: ${windSpeed} km/h / Dir ${windDir}°`;
        document.querySelector(`#${spotId} .temp`).textContent =
          `🌡️ Température eau: ${waterTemp} °C`;
      } catch (err) {
        console.error("Erreur API:", err);
        document.querySelector(`#${spotId} .wave`).textContent = "Erreur de chargement ❌";
      }
    }

    // Coords des spots
    const spots = {
      yoff: { lat: 14.765, lon: -17.405 },
      almadies: { lat: 14.740, lon: -17.500 },
      virage: { lat: 14.730, lon: -17.490 },
      ngor: { lat: 14.749, lon: -17.490 },
      ouakam: { lat: 14.722, lon: -17.490 }
    };

    // Charger chaque spot
    for (const spot in spots) {
      getSpotData(spots[spot].lat, spots[spot].lon, spot);
    }
  </script>
</body>
</html>
