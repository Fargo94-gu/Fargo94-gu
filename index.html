<!DOCTYPE html>
<html lang="fr">
<head>
Â  <meta charset="utf-8"/>
Â  <meta name="viewport" content="width=device-width,initial-scale=1"/>
Â  <title>Surf Spots Dakar â€” Live</title>
Â  <script src="https://cdn.tailwindcss.com"></script>
Â  <style>
Â  Â  body { background:#f0f9ff; font-family: Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto; }
Â  Â  .arrow { display:inline-block; width:36px; height:36px; transform-origin: center center; transition: transform 0.4s ease; }
Â  Â  .spot-card { min-height:220px; }
Â  </style>
</head>
<body class="min-h-screen flex flex-col items-center p-6">
Â  <h1 class="text-2xl font-bold mb-6">ðŸŒŠ Surf Spots - Dakar (live)</h1>

Â  <div id="spots" class="grid md:grid-cols-3 gap-6 w-full max-w-6xl"></div>

Â  <div id="tides" class="mt-10 bg-white p-4 rounded-2xl shadow w-full max-w-3xl text-center"></div>

Â  <button id="refreshBtn" class="mt-6 px-4 py-2 bg-blue-600 text-white rounded-lg shadow hover:bg-blue-700">
Â  Â  Actualiser les donnÃ©es
Â  </button>

Â  <script>
Â  Â  const spots = [
Â  Â  Â  { id: 'yoff', name: "Yoff", lat: 14.765, lon: -17.485 },
Â  Â  Â  { id: 'almadies', name: "Les Almadies", lat: 14.741, lon: -17.531 },
Â  Â  Â  { id: 'virage', name: "Le Virage", lat: 14.755, lon: -17.511 }
Â  Â  ];

Â  Â  function degToCompass(deg) {
Â  Â  Â  const dirs = ["N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW"];
Â  Â  Â  return dirs[Math.round(deg / 22.5) % 16];
Â  Â  }

Â  Â  function arrowSVG() {
Â  Â  Â  return `<svg class="arrow" viewBox="0 0 24 24">
Â  Â  Â  Â  <path d="M12 2 L15 8 H13 V22 H11 V8 H9 L12 2 Z" fill="#075985"/>
Â  Â  Â  </svg>`;
Â  Â  }

Â  Â  function renderUI(spotData, tideData) {
Â  Â  Â  const container = document.getElementById("spots");
Â  Â  Â  const tideDiv = document.getElementById("tides");

Â  Â  Â  const resultsHTML = spotData.map(spot => {
Â  Â  Â  Â  Â  if (!spot.success) {
Â  Â  Â  Â  Â  Â  Â  return `
Â  Â  Â  Â  Â  Â  Â  Â  <div class="bg-red-100 p-4 rounded-2xl shadow text-center flex items-center justify-center spot-card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h2 class="text-lg font-bold mb-2">${spot.name}</h2>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-sm text-red-700">Erreur de chargement</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>`;
Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  const h = spot.data.hourly;
Â  Â  Â  Â  Â  const current = {
Â  Â  Â  Â  Â  Â  Â  height: h.wave_height[0],
Â  Â  Â  Â  Â  Â  Â  period: h.wave_period[0],
Â  Â  Â  Â  Â  Â  Â  windSpeed: h.wind_speed_10m[0] * 3.6,
Â  Â  Â  Â  Â  Â  Â  windDir: h.wind_direction_10m[0]
Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  const bestHeight = Math.max(...h.wave_height.slice(0, 48));

Â  Â  Â  Â  Â  return `
Â  Â  Â  Â  Â  Â  <div class="bg-white p-4 rounded-2xl shadow text-center spot-card">
Â  Â  Â  Â  Â  Â  Â  <h2 class="text-lg font-bold mb-2">${spot.name}</h2>
Â  Â  Â  Â  Â  Â  Â  <div class="flex flex-col items-center mt-2">
Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-4xl">ðŸŒŠ</span>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-sm mt-1">taille = ${current.height.toFixed(1)} m</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-sm">pÃ©riode = ${current.period.toFixed(1)} s</div>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  <div class="mt-3 text-sm text-gray-700">
Â  Â  Â  Â  Â  Â  Â  Â  Vent : ${current.windSpeed.toFixed(1)} km/h (${degToCompass(current.windDir)})
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  <div class="mt-2 flex justify-center">${arrowSVG()}</div>
Â  Â  Â  Â  Â  Â  Â  <div class="mt-3 text-xs text-gray-500">
Â  Â  Â  Â  Â  Â  Â  Â  Meilleure hauteur (48h) : ${bestHeight.toFixed(1)} m
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>`;
Â  Â  Â  }).join("");

Â  Â  Â  container.innerHTML = resultsHTML;

Â  Â  Â  spotData.forEach((spot, i) => {
Â  Â  Â  Â  Â  if (spot.success) {
Â  Â  Â  Â  Â  Â  Â  const card = container.children[i];
Â  Â  Â  Â  Â  Â  Â  const arrow = card.querySelector(".arrow");
Â  Â  Â  Â  Â  Â  Â  if (arrow) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  const deg = spot.data.hourly.wind_direction_10m[0];
Â  Â  Â  Â  Â  Â  Â  Â  Â  arrow.style.transform = `rotate(${deg}deg)`;
Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  }
Â  Â  Â  });

Â  Â  Â  const levels = tideData.hourly.tidal_water_level;
Â  Â  Â  const times = tideData.hourly.time;
Â  Â  Â  const now = new Date();
Â  Â  Â  let nextHigh = null, nextLow = null;

Â  Â  Â  for (let i = 1; i < levels.length - 1; i++) {
Â  Â  Â  Â  Â  const currentTime = new Date(times[i]);
Â  Â  Â  Â  Â  if (currentTime > now) {
Â  Â  Â  Â  Â  Â  Â  if (levels[i] > levels[i - 1] && levels[i] > levels[i + 1] && !nextHigh) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  nextHigh = { time: times[i], val: levels[i] };
Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  if (levels[i] < levels[i - 1] && levels[i] < levels[i + 1] && !nextLow) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  nextLow = { time: times[i], val: levels[i] };
Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  if (nextHigh && nextLow) break;
Â  Â  Â  }

Â  Â  Â  tideDiv.innerHTML = `
Â  Â  Â  Â  <h2 class="text-lg font-bold mb-3">ðŸŒŠ MarÃ©es Ã  Dakar</h2>
Â  Â  Â  Â  <p class="text-sm">Prochaine marÃ©e haute : ${nextHigh ? new Date(nextHigh.time).toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'}) + " (" + nextHigh.val.toFixed(1) + " m)" : "N/A"}</p>
Â  Â  Â  Â  <p class="text-sm">Prochaine marÃ©e basse : ${nextLow ? new Date(nextLow.time).toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'}) + " (" + nextLow.val.toFixed(1) + " m)" : "N/A"}</p>
Â  Â  Â  `;
Â  Â  }

Â  Â  // DonnÃ©es prÃ©chargÃ©es (simulÃ©es)
Â  Â  const preloadedSpotsData = [
Â  Â  Â  {
Â  Â  Â  Â  success: true,
Â  Â  Â  Â  name: "Yoff",
Â  Â  Â  Â  data: { hourly: { wave_height: [0.8, 0.9, 0.7], wave_period: [9.1, 8.8, 9.0], wind_speed_10m: [15, 14, 16], wind_direction_10m: [180, 175, 185] } }
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  success: true,
Â  Â  Â  Â  name: "Les Almadies",
Â  Â  Â  Â  data: { hourly: { wave_height: [1.2, 1.3, 1.1], wave_period: [8.5, 8.3, 8.6], wind_speed_10m: [12, 11, 13], wind_direction_10m: [190, 195, 188] } }
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  success: true,
Â  Â  Â  Â  name: "Le Virage",
Â  Â  Â  Â  data: { hourly: { wave_height: [1.0, 1.1, 0.9], wave_period: [9.2, 9.0, 9.3], wind_speed_10m: [10, 10, 9], wind_direction_10m: [200, 205, 198] } }
Â  Â  Â  }
Â  Â  ];

Â  Â  const preloadedTideData = {
Â  Â  Â  hourly: {
Â  Â  Â  Â  tidal_water_level: [ -0.1, 0.5, 1.2, 0.8, 0.2, -0.4, -0.2, 0.3, 0.9, 0.5 ],
Â  Â  Â  Â  time: [
Â  Â  Â  Â  Â  "2025-09-19T06:00", "2025-09-19T07:00", "2025-09-19T08:00", "2025-09-19T09:00", "2025-09-19T10:00",
Â  Â  Â  Â  Â  "2025-09-19T11:00", "2025-09-19T12:00", "2025-09-19T13:00", "2025-09-19T14:00", "2025-09-19T15:00"
Â  Â  Â  Â  ]
Â  Â  Â  }
Â  Â  };
Â  Â  
Â  Â  // Appel de la fonction pour afficher les donnÃ©es
Â  Â  renderUI(preloadedSpotsData, preloadedTideData);

Â  Â  // Le bouton d'actualisation est dÃ©sactivÃ© pour ce test
Â  Â  document.getElementById("refreshBtn").style.display = "none";
Â  </script>
</body>
</html>
